{% extends 'directory_base.html' %}
{% block content %}
<script type="text/javascript">
        $(document).ready(function(){
            $(".directories_search").click(function(){
                $('.directory_result').hide();
                $('.directory_search_options').hide();
                $('#' + $(this).attr('id') + '_search_options').show();
                $('#' + $(this).attr('id') + '_results').show();
            });
            $("#shop_search").on("click", function(){
                  $.ajax({
                           type: "POST",
                           url: "/directories/search/shop",
                           data: {'name': $("#shop_name").text(), 'ostan': $("#shop_ostan option:selected").text(),
                            'shahr': $("#shop_shahr option:selected").text(),'mahale': $("#shop_mahale option:selected").text(),
                             'category':$("#shop_cat option:selected").text(), csrfmiddlewaretoken:'{{csrf_token}}'},
                           dataType: "json",
                           success: function(data) {
                                       $('#kossher').tetx(data);
                                     if(data){
                                        txt = "";
                                        $.each(data, function(i, item) {
                                            txt += "<div class='span4 bg-hover-gray text-center' style= 'background-color: #efeae3; height: 300px;'><a href='/instrument/"
                                             + item.id + "'><img src='" + item.image + "' class='polaroid' style='max-width: 100%;'><div >"
                                             + item.title + "<br>" + item.instrument + "<br>" + item.price+ " تومن</div></a></div>"
                                        });
                                        if(txt == ""){
                                            txt = "موردی یافت نشد"
                                        }else{
                                            $('#ad_container').html(txt);
                                        }
                                     }
                            },
                            error: function(rs, e) {
                                   alert(rs.responseText);
                            }
                  });
            });
        });
        function search(){
            value = document.getElemetById('saaz').value;
            window.location.href = '/directories/' + value;
        }
        function search(value){
            window.location.href = value;
        }


</script>
<script>
    $(function() {
            $( "#saaz" ).autocomplete({
              source: {{category}}
            });
          });
</script>
    <div dir="rtl" align="right">
    <div id="kossher"></div>
        <form>
            ساز:
            <input id="saaz" name="saaz">
            <button onclick="search()">تایید</button>
        </form>
        <div style="clear: both; background-color: white;">
            <div id="institutes" class="directories_search" style="float: right; width: 200px; height: 100px; border:1px solid black" >آموزشگاه ها</div>
            <div id="manufacturers" class="directories_search" style="float: right; width: 200px; height: 100px; border:1px solid black" align="center">سازنده ها</div>
            <div id="workshops" class="directories_search" style="float: right; width: 200px; height: 100px; border:1px solid black" align="center">تعمیرگاه ها</div>
            <div id="masters" class="directories_search" style="float: right; width: 200px; height: 100px; border:1px solid black" align="center">استادها</div>
            <div id="shops" class="directories_search" style="float: right; width: 200px; height: 100px; border:1px solid black" align="center">فروشگاه ها</div>
        </div>
        <div id="search_result" style="clear: both; background-color: white;">
            <div id="side_bar" style="width: 25%; border: 1px solid black; float: right;">
                <div id="shops_search_options" class="directory_search_options" style="display: none;">
                    <form>
                    <div>
                        <label>نام فروشگاه:</label>
                        <input id="shop_name" name="name" onchange="search(value)">
                    </div>
                    <div class="span4">
                        استان:
                        <div class="input-control select">
                            <select name="shop_ostan" id="shop_ostan" onchange="setShahr('shop_');">
                                    <option value="تهران">تهران</option>
                                    <option value="فارس">فارس</option>
                                    <option value="مازندران">مازندران</option>
                            </select>
                        </div>
                    </div>
                    <div class="span4">
                        شهر:
                        <div class="input-control select">
                            <select name="shop_shahr" id="shop_shahr" onchange="setMahale('shop_');">

                            </select>
                        </div>
                    </div>
                    <div class="span4">
                        محله:
                        <div class="input-control select">
                            <select name="shop_mahale" id="shop_mahale">
                            </select>
                        </div>
                    </div>
                    <label>دسته</label>
                    <select name="shop_cat">
                        <option>سنتی</option>
                        <option>کلاسیک</option>
                    </select>
                    <button id="shop_search_button">بگرد</button>
                    </form>
                </div>
                <div id="workshops_search_options" class="directory_search_options" style="display: none;">
                    <form>
                    <div>
                        <label>نام تعمیرگاه:</label>
                        <input name="name" onchange="search(value)">
                    </div>
                    <div>
                        <label>مکان:</label>
                        <input type="text" name="location">
                    </div>
                    <button id="workshop_search_button">بگرد</button>
                    </form>
                </div>
                <div id="institutes_search_options" class="directory_search_options" style="display: none;">
                    <form>
                    <div>
                        <label>نام آموزشگاه:</label>
                        <input name="name" onchange="search(value)">
                    </div>
                    <div>
                        <label>مکان:</label>
                        <input type="text" name="location">
                    </div>
                    <button id="institute_search_button">بگرد</button>
                    </form>
                </div>
                <div id="manufacturers_search_options" class="directory_search_options" style="display: none;">
                    <form>
                    <div>
                        <label>نام سازنده:</label>
                        <input name="name" onchange="search(value)">
                    </div>
                    <div>
                        <label>مکان:</label>
                        <input type="text" name="location">
                    </div>
                    <button id="manufacturer_search_button">بگرد</button>
                    </form>
                </div>
                <div id="masters_search_options" class="directory_search_options" style="display: none;">
                    <form>
                    <div>
                        <label>نام استاد:</label>
                        <input name="name" onchange="search(value)">
                    </div>
                    <div>
                        <label>مکان:</label>
                        <input type="text" name="location">
                    </div>
                    <button id="masters_search_button">بگرد</button>
                    </form>
                </div>


            </div>
            <div style="width: 70%; float:right;" id="result">
                    <div id="masters_result" class="directory_result">
                        لیست استاد های یافت شده برای ساز {{saaz.name}}
                        {% for m in masters%}
                            <div style="width: 100%; clear:both; background-color: white;">
                                <div style="width: 20%; float: right">
                                    <img src="{{m.image.url}}">
                                </div>
                                <div style="width:80%; float:right; background-color: white;">
                                    <a href="/master/{{m.id}}"><label>{{m.name}}</label></a>
                                    <label>سازهای مربوطه:
                                        {% for i in m.instruments.all%}
                                            {{i.name}},
                                        {% endfor %}
                                    </label>
                                </div>
                            </div>
                        {% endfor %}

                    </div>
                    <div id="institutes_result" class="directory_result">
                        لیست آموزشگاه های یافت شده برای ساز {{saaz.name}}
                        {% for m in institutes%}
                            <div style="width: 100%; clear:both; background-color: white;">
                                <div style="width: 20%; float: right">
                                    <img src="{{m.image.url}}">
                                </div>
                                <div style="width:80%; float:right; background-color: white;">
                                    <a href="/institute/{{m.id}}"><label>{{m.name}}</label></a>
                                    <label>سازهای مربوطه:
                                        {% for i in m.instruments.all%}
                                            {{i.name}},
                                        {% endfor %}
                                    </label>
                                    <label>{{m.resume}}</label>
                                </div>
                            </div>
                        {% endfor %}

                    </div>
                    <div id="manufacturers_result" class="directory_result">
                        {% for m in manufacturer%}
                        لیست سازنده های یافت شده برای ساز {{saaz.name}}
                            <div style="width: 100%; clear:both; background-color: white;">
                                <div style="width: 20%; float: right">
                                    <img src="{{m.image.url}}">
                                </div>
                                <div style="width:80%; float:right; background-color: white;">
                                    <a href="/manufacturer/{{m.id}}"><label>{{m.name}}</label></a>
                                    <label>سازهای مربوطه:
                                        {{m.instrument}}
                                    </label>
                                </div>
                            </div>
                        {% endfor %}

                    </div>
                    <div id="shops_result" class="directory_result">
لیست فروشگاه های یافت شده برای ساز {{saaz.name}}
                        {% for m in shops%}
                            <div style="width: 100%; clear:both; background-color: white;">
                                <div style="width: 20%; float: right">
                                    <img src="{{m.image.url}}">
                                </div>
                                <div style="width:80%; float:right; background-color: white;">
                                    <a href="/shop/{{m.id}}"><label>{{m.name}}</label></a>
                                    <label>دسته:
                                            {{i.category}}
                                    </label>
                                </div>
                            </div>
                        {% endfor %}

                    </div>
                    <div id="workshops_result" class="directory_result">
                        لیست تعمیرگاه های یافت شده برای ساز {{saaz.name}}
                        {% for m in workshop%}
                            <div style="width: 100%; clear:both; background-color: white;">
                                <div style="width: 20%; float: right">
                                    <img src="{{m.image.url}}">
                                </div>
                                <div style="width:80%; float:right; background-color: white;">
                                    <a href="/workshop/{{m.id}}"><label>{{m.name}}</label></a>
                                    <label>سازهای مربوطه:
                                            {{m.instrument}}
                                    </label>
                                </div>
                            </div>
                        {% endfor %}

                    </div>
            </div>
        </div>
    </div>
{% endblock %}